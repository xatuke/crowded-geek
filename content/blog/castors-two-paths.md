---
title: "CastorsCTF | Two Paths"
date: 2020-10-01T02:37:56+05:30
slug: ""
description: "Writeup for two paths in castors ctf."
keywords: ["CastorsCTF", "2020", "Cyber Security", "Writeup"]
draft: false
tags: ["writeup"]
math: false
toc: true
---

## Description
```
The flag is somewhere in these woods, but which path should you take?
```
#### [two-paths.png](https://github.com/crowded-geek/bin/raw/master/two-paths.png)

### Cracking
- We have a classic steganography challenge here but as this is from the crypto category, there must be that also along the way in it.
- I use the `strings` command on the image to see if they've hidden some readable data in this image and I find that there's some binary data at the end of the image.
```
01101000 01110100 01110100 01110000 01110011 00111010 00101111 00101111 01100111 01101111 00101110 01100001 01110111 01110011 00101111 00110010 01111010 01110101 01000011 01000110 01000011 01110000
```
- I use perl to convert this to ascii with the following command:
```bash
echo "01101000011101000111010001110000011100110011101000101111001011110110011101101111001011100110000101110111011100110010111100110010011110100111010101000011010001100100001101110000" | perl -lpe '$_=pack"B*",$_'
```
- Output:
```
https://go.aws/2zuCFCp
```
- The link has expired as the CTF ended but [here's](https://github.com/crowded-geek/bin/blob/master/decode_this_two_path.html) the html page that I got after going to the link.
- As the challenge name says two paths and the above link only contains some random emojis, I ran [`stegsolve`](https://github.com/zardus/ctf-tools/tree/master/stegsolve) on the image and I found another link leading to another image of a chat.
![castorsCTF](https://i.imgur.com/JgEW7I6.png)

    [https://go.aws/2X1R6H7](https://i.imgur.com/EHtidSw.png)

- This image has a chat between two people who are talking about Alex's party or something, Messages from one person are in plain text but from the other person are encrypted with emojis.
- Use the chat to figure out the mappings of the emojis to ascii characters and use that to get the flag.
- My friend [Diogo](https://github.com/diogoscf), [Clash](https://github.com/aadibajpai) and [Halcyon](https://github.com/Uzay-G) helped in mapping out the emojis and Diogo wrote the python script to get the flag.

### Script
```
analysis = {
  "â™ˆ": "c",
  "â™“": "o",
  "â™’": "n",
  "ğŸŒ€": "g",
  "ğŸ”": "r",
  "â™‰": "a",
  "âŒ": "t",
  "ğŸˆ²": "u",
  "â™": "l",
  "âº": "i",
  "â™Š": "s",
  "ğŸ’¯": "f",
  "ğŸ”Ÿ": "y",
  "âœ–": "e",
  "â›": "d",
  "â«": "h",
  "â—": "v",
  "â™‘": "p",
  "ğŸšº": "w",
  "â¿": "j",
  "â“‚": "m",
  "â™Œ": "b",
  "ğŸ”´": "x",
  "â™": "q",
  "ğŸ†”": "k",
  "ğŸ“¶": "z"
}

emoji_encoded = """â™ˆâ™“â™’ğŸŒ€ğŸ”â™‰âŒğŸˆ²â™â™‰âŒâºâ™“â™’â™Š!_âºğŸ’¯_ğŸ”Ÿâ™“ğŸˆ²_â™ˆâ™‰â™’_ğŸ”âœ–â™‰â›_âŒâ«âºâ™Š,_âŒâ«âœ–â™’_ğŸ”Ÿâ™“ğŸˆ²_â«â™‰â—âœ–_â™Šâ™“â™â—âœ–â›_âŒâ«âœ–_â™ˆâºâ™‘â«âœ–ğŸ”!_ğŸšºâœ–_â¿ğŸˆ²â™ŠâŒ_â«â™“â™‘âœ–_ğŸ”Ÿâ™“ğŸˆ²_ğŸ’¯â™“ğŸˆ²â™’â›_â™‰_â“‚â™“ğŸ”âœ–_âœ–ğŸ’¯ğŸ’¯âºâ™ˆâºâœ–â™’âŒ_ğŸšºâ™‰ğŸ”Ÿ_ğŸ’¯â™“ğŸ”_â›âœ–â™ˆâºâ™‘â«âœ–ğŸ”âºâ™’ğŸŒ€_âŒâ«â™‰â™’_ğŸŒ€â™“âºâ™’ğŸŒ€_â™“â™’âœ–_â™ŒğŸ”Ÿ_â™“â™’âœ–_â™“ğŸ”_âœ–â™â™Šâœ–_ğŸ”Ÿâ™“ğŸˆ²_ğŸšºâ™“â™’'âŒ_ğŸŒ€âœ–âŒ_âŒâ«ğŸ”â™“ğŸˆ²ğŸŒ€â«_âŒâ«âœ–_â™’âœ–ğŸ”´âŒ_â™‘â™‰ğŸ”âŒ_â—âœ–ğŸ”ğŸ”Ÿ_â™ğŸˆ²âºâ™ˆğŸ†”â™ğŸ”Ÿ._â“‚â™‰ğŸ”Ÿâ™Œâœ–_âŒğŸ”ğŸ”Ÿ_â™Œâœ–âºâ™’ğŸŒ€_â™‰_â™âºâŒâŒâ™âœ–_â“‚â™“ğŸ”âœ–_â™â™‰ğŸ“¶ğŸ”Ÿ!
â™ˆğŸ’¯â™’_ğŸ†”âºğŸ”´â™‘ğŸ“¶â™Œâ™’_ğŸŒ€ğŸ”´â™ŒğŸ”â™“ğŸ†”â«â«ğŸ”´â«_â“‚ğŸˆ²â™Š{â›ğŸˆ²âºâ«ğŸˆ²â™ˆâ—_ğŸˆ²â«ğŸ†”ğŸ†”}â™Šâ›â¿â«ğŸ’¯â™“_ğŸ†”ğŸˆ²{ğŸ”´ğŸˆ²â«â™’â™‘â™’â“‚}â›_ğŸ“¶ğŸ”â™’â™‘â™’â™’âœ–ğŸ”Ÿ_ğŸ’¯â™‘_â™ˆğŸ†”â™’ğŸ”´ğŸ”ğŸ”âœ–{â™“ğŸ“¶â™_â™ˆâŒğŸŒ€âŒğŸ”â«â™’â™ˆ}ğŸ”´â™Š_{â™“ğŸ’¯â™‰ğŸ’¯â›â¿â™‘â™“ğŸŒ€âŒ_â™“ğŸ”Ÿâ™‘â™ğŸ’¯â™ˆâ™“ğŸ”´}ğŸ“¶â™Œ_ğŸ”Ÿâ«â™“{âŒâ«ğŸ’¯ğŸ”´â™ğŸ”´ğŸ’¯_â™âœ–}ğŸ”´â™‘ğŸ“¶â™“âœ–â™ŒğŸˆ²â—_â™ˆâ™’ğŸ”Ÿâ™ŠğŸ”´âŒ_âŒğŸ“¶â™ğŸšº_ğŸ“¶â›â™’{â—ğŸŒ€â›âœ–â¿ğŸšºâ™“_â¿â™_ğŸ”´âœ–â¿â™ŠâŒâ“‚â™â™‰_ğŸˆ²â—}â¿â™Œâ™“ğŸ’¯â—âœ–â™ˆğŸˆ²_â“‚ğŸ†”ğŸ”´{ğŸ”â™‘â™ŒğŸ’¯â™â™Šâ™ˆ_ğŸ’¯}ğŸšºâºğŸ”ğŸšºâ¿ğŸ’¯â¿â¿â™’_âŒğŸ’¯{â¿â¿â™ŠğŸŒ€â™ˆâ¿}â«âŒ_â«ğŸŒ€â™ğŸ”â™Šâ›â™‰â™‘ğŸ“¶ğŸ†”_â™Šâ™Š{â™“â™‘â™‘â™“ğŸ”Ÿâ™â™‰ğŸŒ€_â™’â™“}â™ŒğŸ”â™’ğŸ“¶ğŸ“¶â™‰âŒğŸˆ²_â™’ğŸ”´ğŸ”Ÿâ™â›ğŸ†”â™{â™‘â™‘â™_â™}ğŸ’¯â«ğŸ”´ğŸ“¶ğŸ”Ÿâ“‚â™ˆğŸ’¯â™‰_â™Šâ›{â™‘â™‘âœ–â¿âœ–ğŸŒ€â«ğŸšº_â“‚â™Œâ¿â«â™ˆâ«ğŸ“¶_â™’âœ–_ğŸ”â™‘â™‰ğŸšºğŸ”ŸğŸ”Ÿâ™’ğŸ”ğŸ“¶ğŸˆ²_â™‘ğŸ”´}ğŸ”â¿ğŸ†”â¿ğŸ’¯ğŸ’¯ğŸ”Ÿâ—_âºâ™‰â™ğŸ”´ğŸ”ŸğŸ”ğŸ”´{â—ğŸ†”âœ–_â™ŠğŸˆ²âºğŸ”_ğŸšºâœ–ğŸ†”âŒğŸˆ²â™“_âŒğŸ’¯{â¿â¿â™ŠğŸŒ€â™ˆâ¿}â«âŒ_â«ğŸŒ€â™ğŸ”â™Šâ›â™‰â™‘ğŸ“¶ğŸ†”_â™Šâ™Š{â™“â™‘â™‘â™“ğŸ”Ÿâ™_â™‰ğŸŒ€_â™’â™“}â™ŒğŸ”â™’ğŸ“¶ğŸ“¶â™‰âŒğŸˆ²_â™’ğŸ”´ğŸ”Ÿâ™â›ğŸ†”â™{â™‘â™‘â™_ğŸ”Ÿâ«â™“{âŒâ«ğŸ’¯â«â™“{âŒâ«ğŸ’¯ğŸ”´â™ğŸ”´ğŸ’¯_â™âœ–}ğŸ”´â™‘ğŸ“¶â™“âœ–â™ŒğŸˆ²â—_â™ˆâ™’ğŸ”Ÿâ™ŠğŸ”´âŒ_âŒğŸ“¶â™ğŸšº_ğŸ“¶â›â™’{â—ğŸŒ€â›âœ–â¿ğŸšºâ™“_â¿â™_ğŸ”´âœ–â¿â™ŠâŒâ“‚â™â™‰_ğŸˆ²â—}â¿â™Œâ™“ğŸ’¯â—âœ–â™ˆğŸˆ²_â“‚ğŸ†”ğŸ”´{ğŸ”â™‘â™ŒğŸ’¯â™â™Šâ™ˆ_ğŸ’¯}ğŸšºâºğŸ”ğŸšºâ¿ğŸ’¯â¿â¿â™’_âŒğŸ’¯{â¿â¿â™ŠğŸŒ€â™ˆâ¿}â«âŒ_â«ğŸŒ€â™ğŸ”â™Šâ›â™‰â™‘ğŸ“¶ğŸ†”_â™Šâ™Š{â™“â™‘â™‘â™“ğŸ”Ÿâ™â™‰ğŸŒ€_â™’â™“}â™ŒğŸ”â™’ğŸ“¶ğŸ“¶â™‰âŒğŸˆ²ğŸ”´â™ğŸ”´ğŸ’¯_â™âœ–}ğŸ”´â™‘ğŸ“¶â™“âœ–â™ŒğŸˆ²â—_â™ˆâ™’ğŸ”Ÿâ™ŠğŸ”´âŒâŒğŸ“¶â™ğŸšº_ğŸ“¶â›â™’{â—_ğŸŒ€â›âœ–â¿ğŸšºâ™“_â¿â™ğŸ”´âœ–â¿â™ŠâŒâ“‚â™â™‰_ğŸˆ²â—}â¿â™Œâ™“ğŸ’¯â—âœ–â™ˆğŸˆ²_â“‚ğŸ†”_ğŸ”´{ğŸ”â™‘â™ŒğŸ’¯â™â™Šâ™ˆ_ğŸ’¯}ğŸšºâºğŸ”ğŸšºâ¿ğŸ’¯_â™ŠğŸˆ²âºğŸ”_ğŸšºâœ–ğŸ†”âŒğŸˆ²â™“_âŒğŸ’¯{â¿â¿â™ŠğŸŒ€â™ˆâ¿}â«âŒ_â«ğŸŒ€â™ğŸ”â™Šâ›â™‰â™‘ğŸ“¶ğŸ†”_â™Šâ™Š{â™“â™‘â™‘â™“ğŸ”Ÿâ™_â™‰ğŸŒ€_â™’â™“}â™ŒğŸ”â™’ğŸ“¶ğŸŒ€ğŸ”´â™ŒğŸ”â™“ğŸ†”â«â«ğŸ”´â«_â“‚ğŸˆ²â™Š{â›ğŸˆ²âºâ«ğŸˆ²â™ˆâ—_ğŸˆ²â«ğŸ†”ğŸ†”}â™Šâ›â¿â«ğŸ’¯â™“_ğŸ†”ğŸˆ²{ğŸ”´ğŸˆ²â«â™’â™‘â™’â“‚}â›_ğŸ“¶ğŸ”â™’â™‘â™’â™’âœ–ğŸ”Ÿ_ğŸ’¯â™‘_â™ˆğŸ†”â™’ğŸ”´ğŸ”ğŸ”âœ–{â™“ğŸ“¶â™_â™ˆâŒğŸŒ€âŒğŸ”â«â™’â™ˆ}ğŸ”´â™Š_{â™“ğŸ’¯â™‰ğŸ’¯â›â¿â™‘â™“ğŸŒ€âŒğŸ“¶â™‰âŒğŸˆ²_â™’ğŸ”´ğŸ”Ÿâ™â›ğŸ†”â™{â™‘â™‘â™_ğŸ”Ÿâ«â™“{âŒâ«ğŸ’¯ğŸ”´â™ğŸ”´ğŸ’¯_â™âœ–}ğŸ”´â™‘ğŸ“¶â™“âœ–â™ŒğŸˆ²â—_â™ˆâ™’ğŸ”Ÿâ™ŠğŸ”´âŒâŒğŸ“¶â™ğŸšºâ¿â¿â™’_âŒğŸ’¯{â¿â¿â™ŠğŸŒ€â™ˆâ¿}â«âŒ_â«ğŸŒ€â™ğŸ”â™Šâ›â™‰â™‘ğŸ“¶ğŸ†”_â“‚â™Œâ¿â«â™ˆâ«ğŸ“¶ğŸ”´_â™’âœ–_ğŸ”â™‘â™‰ğŸšºğŸ”ŸğŸ”Ÿâ™’ğŸ”ğŸ“¶ğŸˆ²_â™‘ğŸ”´}ğŸ”â¿ğŸ†”â¿ğŸ’¯ğŸ’¯ğŸ”Ÿâ—_âºâ™‰â™ğŸ”´_ğŸ”ŸğŸ”ğŸ”´{â—ğŸ†”âœ–_â™ŠğŸˆ²âºğŸ”ğŸšºâœ–ğŸ†”âŒğŸˆ²â™“_â™Œâ™â—{â™‰â™ˆâ™ŒğŸšºâŒâ«ğŸŒ€_â›â™‰â™Œâœ–â™“ğŸ“¶ğŸ”Ÿâœ–ğŸšºâ™“_â™Œâ™“â™’â—ğŸ”´â™â™‰â™“âºâ«_ğŸŒ€â™‰}ğŸˆ²âœ–â™‰ğŸ”Ÿâ“‚â™’ğŸŒ€â™_â™{â™Œâ™’â¿â™’âœ–â™ˆâ™’ğŸ’¯â™’_âœ–}ğŸ”´_â™ŒğŸ”ŸğŸ†”âŒğŸŒ€âœ–ğŸ”ŸâŒ_â™Œâ™“â¿â™Šâ“‚â¿ğŸ”´ğŸ’¯â™‰â“‚_ğŸŒ€â™Šâ“‚â—{â™Œâ™’âŒğŸ“¶ğŸšºğŸ’¯_â—â™Œâœ–â™‰â™âŒâ™Šâ™ŒğŸšºâ™Œ_ğŸŒ€ğŸˆ²â™‘â™Œâ™“âŒğŸ†”â—â™Œ}ğŸ”_â™ˆâ™‰â™ŠâŒâ™“ğŸ”â™Šâ™ˆâŒğŸ’¯{â™Šâ™‰â™’â™ˆâ™“â™ˆâ«â™“_ğŸ’¯â™â™‰ğŸŒ€_â™â¿ğŸ“¶â“‚â™â™‘ğŸŒ€}_â™‘ğŸ’¯{âŒğŸšºâ™â™âºğŸ”â™ğŸ”_â™“ğŸ†”â™ŒğŸ”ğŸ“¶ğŸ“¶âŒğŸšºğŸ”âœ–_â“‚ğŸ“¶â“‚â™ğŸŒ€â™‘â“‚â™ğŸ†”ğŸ”´_ğŸšºâ›ğŸ†”ğŸˆ²â“‚âœ–â™’â™Œâ™‘ğŸ†”_â—â™ˆ}ğŸˆ²ğŸ’¯âŒâœ–âœ–â™âŒğŸ“¶_â™’âŒâ™Š{ğŸ“¶ğŸ†”â™Šâ¿âºâŒâ›_âºâŒâ›ğŸšºâ›ğŸ“¶_ğŸˆ²}ğŸˆ²_â™ˆğŸ†”â«{ğŸ”Ÿâ™â«âŒğŸ”ŸğŸ”´_ğŸ”´â™ˆâ™‰â™’â™ŒğŸ”âœ–ğŸ”´ğŸ’¯â™’_ğŸ“¶}ğŸ“¶ğŸ†”ğŸ“¶ğŸ“¶â¿ğŸ†”ğŸ†”ğŸ’¯ğŸŒ€_âºğŸšºâ™“â™‘âº{ğŸšºâ™“âœ–ğŸ”â™ˆ_â›â™â™‰â“‚}â«â›ğŸ’¯ğŸšº_â«ğŸšº"""

for x, y in analysis.items():
    emoji_encoded = emoji_encoded.replace(x, y)

print(emoji_encoded)
```

#### flag
```
castorsCTF{sancoho_flag_qjzmlpg}
```
